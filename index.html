<!DOCTYPE html>
<head>
<!-- jQuery library -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f7f7f7;
      padding: 20px;
    }
    #result {
      margin-top: 20px;
    }
    .product {
      background: white;
      padding: 15px;
      margin-bottom: 10px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .product h2 {
      margin: 0;
      color: #333;
    }
    .product p {
      margin: 5px 0;
      color: #555;
    }
</style>
</head>
<body>
    <h1>Available Products</h1>
    <div id="result"></div>
    <button id="loadBtn">Button</button>
    <select id="categorySelect"></select>
    <button id="filterBtn">Filter</button>
    <div id="filteredResults"></div>
    <script>
        // variable to store the JSON data
        // and html content  
        let products = [];
        let htmlContent = "";
        // Using $.get() to read the JSON file asynchronously when the button is pressed
        $("#loadBtn").on("click",function(){
            // data is a parameter that is automatically passed into the callback 
            // function by jQuery once it successfully loads the JSON file
            // the file's content is called data 
            $.get("products.json",function(data){
                products = data; 
                let select = document.getElementById("categorySelect");
                // loop through the data (which is an array of products)
                for (var i = 0; i < data.length; i++) {
                    product = data[i];
                    // loop through each product's categories 
                    for (var j = 0; j < product.categories.length; j++) {
                        // checks if this category already exists in the dropdown box 
                        // by looking at the HTML collection of all the option elements
                        // convert it into a real array so that i can use the .some array method 
                        // which checks if any element of the array passes a test
                        // in this scenario if an option matches a category from the product list (will return true or false)
                        if (!Array.from(select.options).some(opt => opt.value === product.categories[j])) {
                            let option = document.createElement("option");
                            option.text = product.categories[j];
                            option.value = product.categories[j];
                            select.add(option);
                        }
                    }
                    var categories = product.categories.join(",");
                    htmlContent += `
                        <div class="product">
                            <h2>${product.name}</h2>
                            <p>${product.description}</p>
                            <p><strong>Price:</strong> $${product.price}</p>
                            <p><strong>Categories:</strong> ${categories}</p>
                        </div>`;
                }
                document.getElementById("result").innerHTML = htmlContent;
            });
        });
        $("#filterBtn").on("click", function(){
            let selectedCategory = document.getElementById("categorySelect").value;
            htmlContent = "";
            // loop through the products 
            for (var i = 0; i < products.length; i++) {
                // if the current product matches the category 
                if (products[i].categories.includes(selectedCategory)) {
                    htmlContent += `
                        <div class="product">
                            <h2>${products[i].name}</h2>
                        </div>`;
                }
            }
            document.getElementById("result").innerHTML = htmlContent; 
        });
    </script>
</body>
</html>
